<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
  </head>
  <body>
    <script>

      $(document).ready(function(){
        var milliseconds = 5000;

        /*
         * shows a snapshot of tweets at a given point in time
         */
        var showTweets = function(inputUser) {
          
          var $body = $('body');
          $body.html('');

          var index = streams.home.length - 1;
          while(index >= 0){
            var tweet = streams.home[index];

            index -= 1;
            if (inputUser !== undefined && tweet.user !== inputUser) {
              continue;
            }
            else { // show tweet 
              var $tweet = $('<div></div>');
              $tweet.html(tweet.created_at + ' <a href="#" class="tweet-link" data-tweeter="' + tweet.user+ '">' + '@' + tweet.user + '</a>: ' + tweet.message);
              $tweet.appendTo($body);
            }
          }
        }; // end function showTweets
        
        /* precondition: showTweets has been invoked */
        var tweetLink = function() {
          $('.tweet-link').on('click', function() {
            stopAutoTweets();
            var tweeter = $(this).data('tweeter');
            showTweets(tweeter);
            var autoShowTweets = setInterval(function() { showTweets(tweeter); }, milliseconds);
          });
        };

        showTweets();
        var autoShowTweets = setInterval(function() { 
          showTweets(); 
          tweetLink();
        }, milliseconds);

        /* precondition: setInterval has been invoked */
        var stopAutoTweets = function() {
          clearInterval(autoShowTweets);
        }

        tweetLink();
      });

    </script>
  </body>
</html>
